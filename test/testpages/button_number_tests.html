<!DOCTYPE html>
<html>
	<head>
		<link rel="shortcut icon" href="../resources/images/favicon.ico" type="image/x-icon">
		<title>Dragon Drop testing</title>
		<script>
	
			function _click(ev) {
				ev.preventDefault();
				var buttonNumber = document.querySelector('#buttonNumber');
				var buttonsNumber = document.querySelector('#buttonsNumber');
				buttonNumber.innerHTML = buttonNumber.innerHTML + " " + ev.button;
				buttonsNumber.innerHTML = buttonsNumber.innerHTML + " " + ev.buttons;
				console.log(ev);
			}	
		
			function allowDrop(ev, targetElement) {
				ev.preventDefault();
				if(targetElement){ targetElement.classList.add('dragOver'); }
			}

			function drag(ev) {	
				ev.dataTransfer.setData("text", ev.target.id);
			}

			function drop(ev) {
				ev.preventDefault();
				var data = ev.dataTransfer.getData("text");
				ev.target.appendChild(document.getElementById(data));
				recordButtonNumber(ev);
			}
			
			function badDrop(ev, targetElement) {
				ev.preventDefault();
				var data = ev.dataTransfer.getData("text");
				ev.target.appendChild(document.getElementById(data));
				targetElement.classList.add('badDrop');
			}
			
			function recordButtonNumber(ev){
				var buttonNumber = document.querySelector('#buttonNumber');
				var buttonsNumber = document.querySelector('#buttonsNumber');
				buttonNumber.innerHTML = buttonNumber.innerHTML + " " + ev.button;
				buttonsNumber.innerHTML = buttonsNumber.innerHTML + " " + ev.buttons;
				console.log(ev);
			}
			
			function clearText(){
				console.log("Gets here");
				var buttonNumber = document.querySelector('#buttonNumber');
				var buttonsNumber = document.querySelector('#buttonsNumber');
				buttonNumber.innerHTML = "Button Number:";
				buttonsNumber.innerHTML = "ButtonS Number:";			
			}
			
		</script>
		<style>
			span.dragTarget {
				display:inline-block;
				height: 60px;
				width: 60px;
				border:1px solid black;
				background-color: white;
				margin-left: auto;
				margin-right: auto;
			}

			span.dragListener {
				display:inline-block;
				height: 60px;
				width: 60px;
				border:1px solid black;
				background-color: grey;
			}

			span.dragOrigin {
				display:inline-block;
				height: 60px;
				width: 60px;
				border:1px solid black;
				background-color: lime;
				margin-left: auto;
				margin-right: auto;
			}
			
			span.dragOver {
				background-color: DarkGreen;
			}
			
			span.badDrop {
				background-color: Red;
			}

			img {
				height: 60px;
			}

		</style>
		


		<link rel="stylesheet" href="../../utils/Xenophon.css">
		<script type="text/javascript" src="../../utils/Xenophon.js"></script>


	</head>
	<body>

		<div id="row1">
			<span id="cell_a0" class="dragTarget"></span>
			<span id="cell_a1" class="dragListener"></span>
			<span id="cell_a2" class="dragTarget"></span>
			<span id="cell_a3" class="dragListener"></span>
			<span id="cell_a4" class="dragTarget"></span>
		</div>
		<div id="row2">
			<span id="cell_b0" class="dragListener"></span>
			<span id="cell_b1" class="dragListener"></span>
			<span id="cell_b2" class="dragListener"></span>
			<span id="cell_b3" class="dragListener"></span>
			<span id="cell_b4" class="dragListener"></span>
		</div>
		<div id="row3">
			<span id="cell_c0" class="dragTarget"></span>
			<span id="cell_c1" class="dragListener"></span>
			<span id="cell_c2" class="dragOrigin">
				<img id="drag1" src="../resources/images/donejs-logo-matrix.png" draggable="true" ondragstart="drag(event)">
			</span>
			<span id="cell_c3" class="dragListener"></span>
			<span id="cell_c4" class="dragTarget"></span>
		</div>
		<button type="button" onclick="_click(event)" oncontextmenu="_click(event)">Click me</button>
		<div id="buttonNumber">Button Number:</div>
		<div id="buttonsNumber">ButtonS Number:</div>
		<button type="button" onclick="clearText()">Clear</button>
		
		
		<script>

			dragTargets = document.querySelectorAll('span.dragTarget');
			dragTargets.forEach(function(elem){
				elem.addEventListener("dragover", function(event){ allowDrop(event); } );
				elem.addEventListener("drop", function(event){ drop(event); });
			});

			dragListeners = document.querySelectorAll('span.dragListener');
			dragListeners.forEach(function(elem){
				elem.addEventListener("dragover", function(event){ allowDrop(event, elem); } );
				elem.addEventListener("drop", function(event){ badDrop(event, elem); });
			});

			drag1.addEventListener("mousemove", function(event){ recordButtonNumber(event); });
			drag1.addEventListener("click", function(event){ recordButtonNumber(event); });
			drag1.addEventListener("mousedown", function(event){ recordButtonNumber(event); });

		</script>

	</body>
</html>